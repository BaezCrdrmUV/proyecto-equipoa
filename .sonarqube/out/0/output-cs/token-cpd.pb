√è
4D:\typeme\MSMensajes\Controllers\GruposController.cs
	namespace 	

MSMensajes
 
. 
Controllers  
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
[ 
Produces 
( 
$str  
)  !
]! "
public 

class 
GruposController !
:" #
ControllerBase$ 2
{ 
private 
readonly 
MensajesContext (
_mensajesContext) 9
;9 :
private 
readonly 
ILogger  
<  !
GruposController! 1
>1 2
_logger3 :
;: ;
private 
const 
int 
VALOR_MINIMO_ID )
=* +
$num, -
;- .
private 
const 
int #
NINGUN_CAMBIO_REALIZADO 1
=2 3
$num4 5
;5 6
private 
JObject 

_resultado "
;" #
public 
GruposController 
(  
ILogger  '
<' (
GruposController( 8
>8 9
logger: @
)@ A
{ 	
_logger 
= 
logger 
; 
_mensajesContext 
= 
new "
MensajesContext# 2
(2 3
)3 4
;4 5
} 	
[&& 	
HttpGet&&	 
(&& 
$str&& 
)&& 
]&& 
public'' 
async'' 
Task'' 
<'' 
ActionResult'' &
<''& '
JObject''' .
>''. /
>''/ 0
ObtenerGrupos''1 >
(''> ?
[''? @
	FromQuery''@ I
]''I J
string''J P
nombre''Q W
=''W X
$str''X Z
,''Z [
[''\ ]
	FromQuery''] f
]''f g
int''g j
idGrupo''k r
=''s t
-''u v
$num''v w
)''w x
{(( 	
List)) 
<)) 
Grupo)) 
>)) 
grupos)) 
=))  
null))! %
;))% &
try++ 
{,, 
grupos-- 
=-- 
await-- 
_mensajesContext-- /
.--/ 0
Grupos--0 6
... 
Where.. 
(.. 
grupo..  
=>..! #
grupo..$ )
...) *
Nombre..* 0
...0 1
Contains..1 9
(..9 :
nombre..: @
)..@ A
)..A B
.// 
Where// 
(// 
grupo//  
=>//! #
(//$ %
idGrupo//% ,
>=//- /
$num//0 1
&&//2 4
grupo//5 :
.//: ;
IdGrupo//; B
==//C E
idGrupo//F M
)//M N
||//O Q
(00$ %
idGrupo00% ,
<00- .
$num00/ 0
&&001 3
grupo004 9
.009 :
IdGrupo00: A
!=00B D
idGrupo00E L
)00L M
)00M N
.11 
ToListAsync11  
(11  !
)11! "
;11" #
}22 
catch33 
(33 !
ArgumentNullException33 (
e33) *
)33* +
{44 
_logger55 
.55 
LogError55  
(55  !
$str55! ;
+55< =
e55> ?
.55? @
Message55@ G
)55G H
;55H I

_resultado66 
=66 
ConvertidorDeJson66 .
.66. /%
ConvertirResultadoFallido66/ H
(66H I
e66I J
.66J K
Message66K R
)66R S
;66S T
return77 

BadRequest77 !
(77! "

_resultado77" ,
)77, -
;77- .
}88 
catch99 
(99 
MySqlException99 !
e99" #
)99# $
{:: 
_logger;; 
.;; 
LogError;;  
(;;  !
$str;;! ;
+;;< =
e;;> ?
.;;? @
Message;;@ G
);;G H
;;;H I

_resultado<< 
=<< 
ConvertidorDeJson<< .
.<<. /%
ConvertirResultadoFallido<</ H
(<<H I
e<<I J
.<<J K
Message<<K R
)<<R S
;<<S T
return== 

BadRequest== !
(==! "

_resultado==" ,
)==, -
;==- .
}>> 
if@@ 
(@@ 
grupos@@ 
==@@ 
null@@ 
||@@ !
grupos@@" (
.@@( )
Count@@) .
==@@/ 1
$num@@2 3
)@@3 4
{AA 

_resultadoBB 
=BB 
ConvertidorDeJsonBB .
.BB. /%
ConvertirResultadoFallidoBB/ H
(BBH I
$strBBI u
)BBu v
;BBv w
returnCC 

BadRequestCC !
(CC! "

_resultadoCC" ,
)CC, -
;CC- .
}DD 

_resultadoFF 
=FF 
ConvertidorDeJsonFF *
.FF* +%
ConvertirResultadoExitosoFF+ D
(FFD E
$strFFE Y
,FFY Z
gruposFF[ a
)FFa b
;FFb c
returnHH 
OkHH 
(HH 

_resultadoHH  
)HH  !
;HH! "
}II 	
[KK 	
HttpGetKK	 
(KK 
$strKK &
)KK& '
]KK' (
publicLL 
asyncLL 
TaskLL 
<LL 
ActionResultLL &
<LL& '
JObjectLL' .
>LL. /
>LL/ 0
ObtenerMisGruposLL1 A
(LLA B
stringLLB H
idTyperLLI P
)LLP Q
{MM 	
ListNN 
<NN 
GrupoNN 
>NN 
gruposNN 
=NN  
nullNN! %
;NN% &
tryPP 
{QQ 
gruposRR 
=RR 
awaitRR 
_mensajesContextRR /
.RR/ 0

PertenecesRR0 :
.SS 
WhereSS 
(SS 

integranteSS %
=>SS& (

integranteSS) 3
.SS3 4
IdTyperSS4 ;
.SS; <
EqualsSS< B
(SSB C
idTyperSSC J
)SSJ K
)SSK L
.TT 
IncludeTT 
(TT 

integranteTT '
=>TT( *

integranteTT+ 5
.TT5 6
IdGrupoNavigationTT6 G
)TTG H
.UU 
SelectUU 
(UU 
grupoUU !
=>UU" $
newUU% (
GrupoUU) .
{UU/ 0
IdGrupoVV 
=VV  !
grupoVV" '
.VV' (
IdGrupoVV( /
,VV/ 0
NombreWW 
=WW  
grupoWW! &
.WW& '
IdGrupoNavigationWW' 8
.WW8 9
NombreWW9 ?
,WW? @
DescripcionXX #
=XX$ %
grupoXX& +
.XX+ ,
IdGrupoNavigationXX, =
.XX= >
DescripcionXX> I
,XXI J
FechaCreacionYY %
=YY& '
grupoYY( -
.YY- .
IdGrupoNavigationYY. ?
.YY? @
FechaCreacionYY@ M
}ZZ 
)ZZ 
.[[ 
ToListAsync[[  
([[  !
)[[! "
;[[" #
}\\ 
catch]] 
(]] !
ArgumentNullException]] (
e]]) *
)]]* +
{^^ 
_logger__ 
.__ 
LogError__  
(__  !
$str__! ;
+__< =
e__> ?
.__? @
Message__@ G
)__G H
;__H I

_resultado`` 
=`` 
ConvertidorDeJson`` .
.``. /%
ConvertirResultadoFallido``/ H
(``H I
e``I J
.``J K
Message``K R
)``R S
;``S T
returnaa 

BadRequestaa !
(aa! "

_resultadoaa" ,
)aa, -
;aa- .
}bb 
catchcc 
(cc 
MySqlExceptioncc !
ecc" #
)cc# $
{dd 
_loggeree 
.ee 
LogErroree  
(ee  !
$stree! ;
+ee< =
eee> ?
.ee? @
Messageee@ G
)eeG H
;eeH I

_resultadoff 
=ff 
ConvertidorDeJsonff .
.ff. /%
ConvertirResultadoFallidoff/ H
(ffH I
effI J
.ffJ K
MessageffK R
)ffR S
;ffS T
returngg 

BadRequestgg !
(gg! "

_resultadogg" ,
)gg, -
;gg- .
}hh 
ifjj 
(jj 
gruposjj 
==jj 
nulljj 
||jj !
gruposjj" (
.jj( )
Countjj) .
==jj/ 1
$numjj2 3
)jj3 4
{kk 

_resultadoll 
=ll 
ConvertidorDeJsonll .
.ll. /%
ConvertirResultadoFallidoll/ H
(llH I
$strllI u
)llu v
;llv w
returnmm 

BadRequestmm !
(mm! "

_resultadomm" ,
)mm, -
;mm- .
}nn 

_resultadopp 
=pp 
ConvertidorDeJsonpp *
.pp* +%
ConvertirResultadoExitosopp+ D
(ppD E
$strppE Y
,ppY Z
grupospp[ a
)ppa b
;ppb c
returnrr 
Okrr 
(rr 

_resultadorr  
)rr  !
;rr! "
}ss 	
[zz 	
HttpGetzz	 
(zz 
$strzz (
)zz( )
]zz) *
public{{ 
async{{ 
Task{{ 
<{{ 
ActionResult{{ &
<{{& '
JObject{{' .
>{{. /
>{{/ 0%
ObtenerIntegrantesDeGrupo{{1 J
({{J K
int{{K N
idGrupo{{O V
){{V W
{|| 	
List}} 
<}} 
	Pertenece}} 
>}} 
integrantesDeGrupo}} .
=}}/ 0
null}}1 5
;}}5 6
if 
( 
idGrupo 
< 
VALOR_MINIMO_ID )
)) *
{
ÄÄ 

_resultado
ÅÅ 
=
ÅÅ 
ConvertidorDeJson
ÅÅ .
.
ÅÅ. /'
ConvertirResultadoFallido
ÅÅ/ H
(
ÅÅH I
$str
ÅÅI b
)
ÅÅb c
;
ÅÅc d
return
ÇÇ 

BadRequest
ÇÇ !
(
ÇÇ! "

_resultado
ÇÇ" ,
)
ÇÇ, -
;
ÇÇ- .
}
ÉÉ 
try
ÖÖ 
{
ÜÜ  
integrantesDeGrupo
áá "
=
áá# $
await
áá% *
_mensajesContext
áá+ ;
.
áá; <

Perteneces
áá< F
.
àà 
Where
àà 
(
àà 
	pertenece
àà $
=>
àà% '
	pertenece
àà( 1
.
àà1 2
IdGrupo
àà2 9
==
àà: <
idGrupo
àà= D
)
ààD E
.
ââ 
ToListAsync
ââ  
(
ââ  !
)
ââ! "
;
ââ" #
}
ää 
catch
ãã 
(
ãã #
ArgumentNullException
ãã (
e
ãã) *
)
ãã* +
{
åå 
_logger
çç 
.
çç 
LogError
çç  
(
çç  !
$str
çç! ;
+
çç< =
e
çç> ?
.
çç? @
Message
çç@ G
)
ççG H
;
ççH I

_resultado
éé 
=
éé 
ConvertidorDeJson
éé .
.
éé. /'
ConvertirResultadoFallido
éé/ H
(
ééH I
e
ééI J
.
ééJ K
Message
ééK R
)
ééR S
;
ééS T
return
èè 

BadRequest
èè !
(
èè! "

_resultado
èè" ,
)
èè, -
;
èè- .
}
êê 
catch
ëë 
(
ëë 
MySqlException
ëë !
e
ëë" #
)
ëë# $
{
íí 
_logger
ìì 
.
ìì 
LogError
ìì  
(
ìì  !
$str
ìì! ;
+
ìì< =
e
ìì> ?
.
ìì? @
Message
ìì@ G
)
ììG H
;
ììH I

_resultado
îî 
=
îî 
ConvertidorDeJson
îî .
.
îî. /'
ConvertirResultadoFallido
îî/ H
(
îîH I
e
îîI J
.
îîJ K
Message
îîK R
)
îîR S
;
îîS T
return
ïï 

BadRequest
ïï !
(
ïï! "

_resultado
ïï" ,
)
ïï, -
;
ïï- .
}
ññ 
int
òò 
noHayIntegrantes
òò  
=
òò! "
$num
òò# $
;
òò$ %
if
ôô 
(
ôô  
integrantesDeGrupo
ôô "
==
ôô# %
null
ôô& *
||
ôô+ - 
integrantesDeGrupo
ôô. @
.
ôô@ A
Count
ôôA F
==
ôôG I
noHayIntegrantes
ôôJ Z
)
ôôZ [
{
öö 

_resultado
õõ 
=
õõ 
ConvertidorDeJson
õõ .
.
õõ. /'
ConvertirResultadoFallido
õõ/ H
(
õõH I
$str
õõI r
)
õõr s
;
õõs t
return
úú 

BadRequest
úú !
(
úú! "

_resultado
úú" ,
)
úú, -
;
úú- .
}
ùù 

_resultado
üü 
=
üü 
ConvertidorDeJson
üü *
.
üü* +'
ConvertirResultadoExitoso
üü+ D
(
üüD E
$str
üüE ^
,
üü^ _ 
integrantesDeGrupo
üü` r
)
üür s
;
üüs t
return
†† 
Ok
†† 
(
†† 

_resultado
††  
)
††  !
;
††! "
}
¢¢ 	
[
©© 	
HttpPost
©©	 
(
©© 
$str
©© 
)
©© 
]
©©  
public
™™ 
async
™™ 
Task
™™ 
<
™™ 
ActionResult
™™ &
<
™™& '
JObject
™™' .
>
™™. /
>
™™/ 0

CrearGrupo
™™1 ;
(
™™; <
[
™™< =
FromBody
™™= E
]
™™E F
Grupo
™™G L

nuevoGrupo
™™M W
)
™™W X
{
´´ 	
if
¨¨ 
(
¨¨ 

nuevoGrupo
¨¨ 
==
¨¨ 
null
¨¨ "
)
¨¨" #
{
≠≠ 
_logger
ÆÆ 
.
ÆÆ 
LogError
ÆÆ  
(
ÆÆ  !
$str
ÆÆ! I
)
ÆÆI J
;
ÆÆJ K

_resultado
ØØ 
=
ØØ 
ConvertidorDeJson
ØØ .
.
ØØ. /'
ConvertirResultadoFallido
ØØ/ H
(
ØØH I
$str
ØØI q
)
ØØq r
;
ØØr s
return
∞∞ 

BadRequest
∞∞ !
(
∞∞! "

_resultado
∞∞" ,
)
∞∞, -
;
∞∞- .
}
±± 

nuevoGrupo
≥≥ 
.
≥≥ 
FechaCreacion
≥≥ $
=
≥≥% &
DateTime
≥≥' /
.
≥≥/ 0
Now
≥≥0 3
;
≥≥3 4
_mensajesContext
¥¥ 
.
¥¥ 
Entry
¥¥ "
(
¥¥" #

nuevoGrupo
¥¥# -
)
¥¥- .
.
¥¥. /
State
¥¥/ 4
=
¥¥5 6
EntityState
¥¥7 B
.
¥¥B C
Added
¥¥C H
;
¥¥H I
_mensajesContext
µµ 
.
µµ 
AddRange
µµ %
(
µµ% &

nuevoGrupo
µµ& 0
.
µµ0 1

Perteneces
µµ1 ;
)
µµ; <
;
µµ< =
int
∑∑ 
	resultado
∑∑ 
;
∑∑ 
try
ππ 
{
∫∫ 
	resultado
ªª 
=
ªª 
await
ªª !
_mensajesContext
ªª" 2
.
ªª2 3
SaveChangesAsync
ªª3 C
(
ªªC D
)
ªªD E
;
ªªE F
}
ºº 
catch
ΩΩ 
(
ΩΩ 
DbUpdateException
ΩΩ $
e
ΩΩ% &
)
ΩΩ& '
{
ææ 
_logger
øø 
.
øø 
LogError
øø  
(
øø  !
$str
øø! ;
+
øø< =
e
øø> ?
.
øø? @
InnerException
øø@ N
.
øøN O
Message
øøO V
)
øøV W
;
øøW X

_resultado
¿¿ 
=
¿¿ 
ConvertidorDeJson
¿¿ .
.
¿¿. /'
ConvertirResultadoFallido
¿¿/ H
(
¿¿H I
e
¿¿I J
.
¿¿J K
InnerException
¿¿K Y
.
¿¿Y Z
Message
¿¿Z a
)
¿¿a b
;
¿¿b c
return
¡¡ 

BadRequest
¡¡ !
(
¡¡! "

_resultado
¡¡" ,
)
¡¡, -
;
¡¡- .
}
¬¬ 
if
ƒƒ 
(
ƒƒ 
	resultado
ƒƒ 
==
ƒƒ %
NINGUN_CAMBIO_REALIZADO
ƒƒ 4
)
ƒƒ4 5
{
≈≈ 

_resultado
∆∆ 
=
∆∆ 
ConvertidorDeJson
∆∆ .
.
∆∆. /'
ConvertirResultadoFallido
∆∆/ H
(
∆∆H I
$str
∆∆I Z
)
∆∆Z [
;
∆∆[ \
return
«« 

BadRequest
«« !
(
««! "

_resultado
««" ,
)
««, -
;
««- .
}
»» 
_logger
   
.
   
LogInformation
   "
(
  " #
$str
  # <
,
  < =

nuevoGrupo
  > H
.
  H I
Nombre
  I O
)
  O P
;
  P Q

_resultado
ÀÀ 
=
ÀÀ 
ConvertidorDeJson
ÀÀ *
.
ÀÀ* +'
ConvertirResultadoExitoso
ÀÀ+ D
(
ÀÀD E
$str
ÀÀE Y
,
ÀÀY Z

nuevoGrupo
ÀÀ[ e
)
ÀÀe f
;
ÀÀf g
return
ÃÃ 
Ok
ÃÃ 
(
ÃÃ 

_resultado
ÃÃ  
)
ÃÃ  !
;
ÃÃ! "
}
ÕÕ 	
[
’’ 	
HttpPut
’’	 
(
’’ 
$str
’’ '
)
’’' (
]
’’( )
public
÷÷ 
async
÷÷ 
Task
÷÷ 
<
÷÷ 
ActionResult
÷÷ &
<
÷÷& '
JObject
÷÷' .
>
÷÷. /
>
÷÷/ 0
ActualizarGrupo
÷÷1 @
(
÷÷@ A
int
÷÷A D
idGrupo
÷÷E L
=
÷÷M N
$num
÷÷O P
,
÷÷P Q
[
÷÷R S
FromBody
÷÷S [
]
÷÷[ \
Grupo
÷÷] b
grupoActualizado
÷÷c s
=
÷÷t u
null
÷÷v z
)
÷÷z {
{
◊◊ 	
if
ÿÿ 
(
ÿÿ 
grupoActualizado
ÿÿ  
==
ÿÿ! #
null
ÿÿ$ (
)
ÿÿ( )
{
ŸŸ 
_logger
⁄⁄ 
.
⁄⁄ 
LogError
⁄⁄  
(
⁄⁄  !
$str
⁄⁄! [
)
⁄⁄[ \
;
⁄⁄\ ]

_resultado
€€ 
=
€€ 
ConvertidorDeJson
€€ .
.
€€. /'
ConvertirResultadoFallido
€€/ H
(
€€H I
$str€€I É
)€€É Ñ
;€€Ñ Ö
return
‹‹ 

BadRequest
‹‹ !
(
‹‹! "

_resultado
‹‹" ,
)
‹‹, -
;
‹‹- .
}
›› 
if
ﬂﬂ 
(
ﬂﬂ 
idGrupo
ﬂﬂ 
<
ﬂﬂ 
VALOR_MINIMO_ID
ﬂﬂ )
)
ﬂﬂ) *
{
‡‡ 

_resultado
·· 
=
·· 
ConvertidorDeJson
·· .
.
··. /'
ConvertirResultadoFallido
··/ H
(
··H I
$str
··I t
)
··t u
;
··u v
return
‚‚ 

BadRequest
‚‚ !
(
‚‚! "

_resultado
‚‚" ,
)
‚‚, -
;
‚‚- .
}
„„ 
Grupo
ÂÂ 
grupoAActualizar
ÂÂ "
=
ÂÂ# $
_mensajesContext
ÂÂ% 5
.
ÂÂ5 6
Grupos
ÂÂ6 <
.
ÂÂ< =
SingleOrDefault
ÂÂ= L
(
ÂÂL M
grupo
ÂÂM R
=>
ÂÂS U
grupo
ÂÂV [
.
ÂÂ[ \
IdGrupo
ÂÂ\ c
==
ÂÂd f
idGrupo
ÂÂg n
)
ÂÂn o
;
ÂÂo p
if
ÁÁ 
(
ÁÁ 
grupoAActualizar
ÁÁ  
==
ÁÁ! #
null
ÁÁ$ (
)
ÁÁ( )
{
ËË 

_resultado
ÈÈ 
=
ÈÈ 
ConvertidorDeJson
ÈÈ .
.
ÈÈ. /'
ConvertirResultadoFallido
ÈÈ/ H
(
ÈÈH I
$str
ÈÈI ^
)
ÈÈ^ _
;
ÈÈ_ `
return
ÍÍ 

BadRequest
ÍÍ !
(
ÍÍ! "

_resultado
ÍÍ" ,
)
ÍÍ, -
;
ÍÍ- .
}
ÎÎ 
grupoAActualizar
ÌÌ 
.
ÌÌ 
Nombre
ÌÌ #
=
ÌÌ$ %
grupoActualizado
ÌÌ& 6
.
ÌÌ6 7
Nombre
ÌÌ7 =
;
ÌÌ= >
grupoAActualizar
ÓÓ 
.
ÓÓ 
Descripcion
ÓÓ (
=
ÓÓ) *
grupoActualizado
ÓÓ+ ;
.
ÓÓ; <
Descripcion
ÓÓ< G
;
ÓÓG H
_mensajesContext
 
.
 
Entry
 "
(
" #
grupoAActualizar
# 3
)
3 4
.
4 5
State
5 :
=
; <
EntityState
= H
.
H I
Modified
I Q
;
Q R
int
ÚÚ 
	resultado
ÚÚ 
;
ÚÚ 
try
ÙÙ 
{
ıı 
	resultado
ˆˆ 
=
ˆˆ 
await
ˆˆ !
_mensajesContext
ˆˆ" 2
.
ˆˆ2 3
SaveChangesAsync
ˆˆ3 C
(
ˆˆC D
)
ˆˆD E
;
ˆˆE F
}
˜˜ 
catch
¯¯ 
(
¯¯ 
DbUpdateException
¯¯ $
e
¯¯% &
)
¯¯& '
{
˘˘ 
_logger
˙˙ 
.
˙˙ 
LogError
˙˙  
(
˙˙  !
$str
˙˙! ;
+
˙˙< =
e
˙˙> ?
.
˙˙? @
Message
˙˙@ G
)
˙˙G H
;
˙˙H I

_resultado
˚˚ 
=
˚˚ 
ConvertidorDeJson
˚˚ .
.
˚˚. /'
ConvertirResultadoFallido
˚˚/ H
(
˚˚H I
e
˚˚I J
.
˚˚J K
Message
˚˚K R
)
˚˚R S
;
˚˚S T
return
¸¸ 

BadRequest
¸¸ !
(
¸¸! "

_resultado
¸¸" ,
)
¸¸, -
;
¸¸- .
}
˝˝ 
if
ˇˇ 
(
ˇˇ 
	resultado
ˇˇ 
==
ˇˇ %
NINGUN_CAMBIO_REALIZADO
ˇˇ 4
)
ˇˇ4 5
{
ÄÄ 

_resultado
ÅÅ 
=
ÅÅ 
ConvertidorDeJson
ÅÅ .
.
ÅÅ. /'
ConvertirResultadoFallido
ÅÅ/ H
(
ÅÅH I
$str
ÅÅI i
)
ÅÅi j
;
ÅÅj k
return
ÇÇ 

BadRequest
ÇÇ !
(
ÇÇ! "

_resultado
ÇÇ" ,
)
ÇÇ, -
;
ÇÇ- .
}
ÉÉ 
_logger
ÖÖ 
.
ÖÖ 
LogInformation
ÖÖ "
(
ÖÖ" #
$str
ÖÖ# ;
,
ÖÖ; <
grupoAActualizar
ÖÖ= M
.
ÖÖM N
Nombre
ÖÖN T
)
ÖÖT U
;
ÖÖU V

_resultado
ÜÜ 
=
ÜÜ 
ConvertidorDeJson
ÜÜ *
.
ÜÜ* +'
ConvertirResultadoExitoso
ÜÜ+ D
(
ÜÜD E
$str
ÜÜE X
,
ÜÜX Y
grupoAActualizar
ÜÜZ j
)
ÜÜj k
;
ÜÜk l
return
áá 
Ok
áá 
(
áá 

_resultado
áá  
)
áá  !
;
áá! "
}
àà 	
[
êê 	
HttpPost
êê	 
(
êê 
$str
êê 0
)
êê0 1
]
êê1 2
public
ëë 
async
ëë 
Task
ëë 
<
ëë 
ActionResult
ëë &
<
ëë& '
JObject
ëë' .
>
ëë. /
>
ëë/ 0&
AgregarIntegrantesAGrupo
ëë1 I
(
ëëI J
int
ëëJ M
idGrupo
ëëN U
,
ëëU V
[
ëëW X
FromBody
ëëX `
]
ëë` a
List
ëëb f
<
ëëf g
	Pertenece
ëëg p
>
ëëp q
integrantes
ëër }
)
ëë} ~
{
íí 	
if
ìì 
(
ìì 
integrantes
ìì 
==
ìì 
null
ìì #
)
ìì# $
{
îî 
_logger
ïï 
.
ïï 
LogError
ïï  
(
ïï  !
$str
ïï! I
)
ïïI J
;
ïïJ K

_resultado
ññ 
=
ññ 
ConvertidorDeJson
ññ .
.
ññ. /'
ConvertirResultadoFallido
ññ/ H
(
ññH I
$str
ññI q
)
ññq r
;
ññr s
return
óó 

BadRequest
óó !
(
óó! "

_resultado
óó" ,
)
óó, -
;
óó- .
}
òò 
if
öö 
(
öö 
idGrupo
öö 
<
öö 
VALOR_MINIMO_ID
öö )
)
öö) *
{
õõ 
_logger
úú 
.
úú 
LogError
úú  
(
úú  !
$str
úú! L
)
úúL M
;
úúM N

_resultado
ùù 
=
ùù 
ConvertidorDeJson
ùù .
.
ùù. /'
ConvertirResultadoFallido
ùù/ H
(
ùùH I
$str
ùùI t
)
ùùt u
;
ùùu v
return
ûû 

BadRequest
ûû !
(
ûû! "

_resultado
ûû" ,
)
ûû, -
;
ûû- .
}
üü 
bool
°° 
existeGrupo
°° 
=
°° 
_mensajesContext
°° /
.
°°/ 0
Grupos
°°0 6
.
°°6 7
Any
°°7 :
(
°°: ;
grupo
°°; @
=>
°°A C
grupo
°°D I
.
°°I J
IdGrupo
°°J Q
==
°°R T
idGrupo
°°U \
)
°°\ ]
;
°°] ^
if
££ 
(
££ 
!
££ 
existeGrupo
££ 
)
££ 
{
§§ 

_resultado
•• 
=
•• 
ConvertidorDeJson
•• .
.
••. /'
ConvertirResultadoFallido
••/ H
(
••H I
$str
••I u
)
••u v
;
••v w
return
¶¶ 

BadRequest
¶¶ !
(
¶¶! "

_resultado
¶¶" ,
)
¶¶, -
;
¶¶- .
}
ßß 
_mensajesContext
©© 
.
©© 

Perteneces
©© '
.
©©' (
AddRange
©©( 0
(
©©0 1
integrantes
©©1 <
)
©©< =
;
©©= >
int
´´ 
	resultado
´´ 
;
´´ 
try
≠≠ 
{
ÆÆ 
	resultado
ØØ 
=
ØØ 
await
ØØ !
_mensajesContext
ØØ" 2
.
ØØ2 3
SaveChangesAsync
ØØ3 C
(
ØØC D
)
ØØD E
;
ØØE F
}
∞∞ 
catch
±± 
(
±± 
DbUpdateException
±± $
e
±±% &
)
±±& '
when
±±( ,
(
±±- .
e
±±. /
.
±±/ 0
InnerException
±±0 >
is
±±? A
MySqlException
±±B P
mysqlException
±±Q _
&&
±±` b
(
±±c d
mysqlException
±±d r
.
±±r s
Number
±±s y
==
±±z |
$num±±} Å
)±±Å Ç
)±±Ç É
{
≤≤ 
_logger
≥≥ 
.
≥≥ 
LogError
≥≥  
(
≥≥  !
$str
≥≥! ;
+
≥≥< =
mysqlException
≥≥> L
.
≥≥L M
Message
≥≥M T
)
≥≥T U
;
≥≥U V

_resultado
¥¥ 
=
¥¥ 
ConvertidorDeJson
¥¥ .
.
¥¥. /'
ConvertirResultadoFallido
¥¥/ H
(
¥¥H I
$str
¥¥I y
)
¥¥y z
;
¥¥z {
return
µµ 

BadRequest
µµ !
(
µµ! "

_resultado
µµ" ,
)
µµ, -
;
µµ- .
}
∂∂ 
catch
∑∑ 
(
∑∑ 
DbUpdateException
∑∑ $
e
∑∑% &
)
∑∑& '
{
∏∏ 
_logger
ππ 
.
ππ 
LogError
ππ  
(
ππ  !
$str
ππ! ;
+
ππ< =
e
ππ> ?
.
ππ? @
InnerException
ππ@ N
.
ππN O
Message
ππO V
)
ππV W
;
ππW X

_resultado
∫∫ 
=
∫∫ 
ConvertidorDeJson
∫∫ .
.
∫∫. /'
ConvertirResultadoFallido
∫∫/ H
(
∫∫H I
e
∫∫I J
.
∫∫J K
InnerException
∫∫K Y
.
∫∫Y Z
Message
∫∫Z a
)
∫∫a b
;
∫∫b c
return
ªª 

BadRequest
ªª !
(
ªª! "

_resultado
ªª" ,
)
ªª, -
;
ªª- .
}
ºº 
catch
ΩΩ 
(
ΩΩ '
InvalidOperationException
ΩΩ ,
e
ΩΩ- .
)
ΩΩ. /
{
ææ 
_logger
øø 
.
øø 
LogError
øø  
(
øø  !
$str
øø! ;
+
øø< =
e
øø> ?
.
øø? @
Message
øø@ G
)
øøG H
;
øøH I

_resultado
¿¿ 
=
¿¿ 
ConvertidorDeJson
¿¿ .
.
¿¿. /'
ConvertirResultadoFallido
¿¿/ H
(
¿¿H I
e
¿¿I J
.
¿¿J K
Message
¿¿K R
)
¿¿R S
;
¿¿S T
return
¡¡ 

BadRequest
¡¡ !
(
¡¡! "

_resultado
¡¡" ,
)
¡¡, -
;
¡¡- .
}
¬¬ 
if
≈≈ 
(
≈≈ 
	resultado
≈≈ 
==
≈≈ %
NINGUN_CAMBIO_REALIZADO
≈≈ 4
)
≈≈4 5
{
∆∆ 

_resultado
«« 
=
«« 
ConvertidorDeJson
«« .
.
««. /'
ConvertirResultadoFallido
««/ H
(
««H I
$str
««I q
)
««q r
;
««r s
return
»» 

BadRequest
»» !
(
»»! "

_resultado
»»" ,
)
»», -
;
»»- .
}
…… 

_resultado
ÀÀ 
=
ÀÀ 
ConvertidorDeJson
ÀÀ *
.
ÀÀ* +'
ConvertirResultadoExitoso
ÀÀ+ D
(
ÀÀD E
$str
ÀÀE `
,
ÀÀ` a
integrantes
ÀÀb m
)
ÀÀm n
;
ÀÀn o
return
ÃÃ 
Ok
ÃÃ 
(
ÃÃ 

_resultado
ÃÃ  
)
ÃÃ  !
;
ÃÃ! "
}
ÕÕ 	
[
’’ 	
HttpPut
’’	 
(
’’ 
$str
’’ 
)
’’ 
]
’’ 
public
÷÷ 
async
÷÷ 
Task
÷÷ 
<
÷÷ 
ActionResult
÷÷ &
<
÷÷& '
bool
÷÷' +
>
÷÷+ ,
>
÷÷, -
SalirDeGrupo
÷÷. :
(
÷÷: ;
[
÷÷; <
	FromQuery
÷÷< E
]
÷÷E F
int
÷÷G J
idGrupo
÷÷K R
=
÷÷S T
-
÷÷U V
$num
÷÷V W
,
÷÷W X
[
÷÷Y Z
	FromQuery
÷÷Z c
]
÷÷c d
string
÷÷e k
idTyper
÷÷l s
=
÷÷t u
$str
÷÷v x
)
÷÷x y
{
◊◊ 	
if
ÿÿ 
(
ÿÿ 
idGrupo
ÿÿ 
<
ÿÿ 
VALOR_MINIMO_ID
ÿÿ )
)
ÿÿ) *
{
ŸŸ 

_resultado
⁄⁄ 
=
⁄⁄ 
ConvertidorDeJson
⁄⁄ .
.
⁄⁄. /'
ConvertirResultadoFallido
⁄⁄/ H
(
⁄⁄H I
$str
⁄⁄I s
)
⁄⁄s t
;
⁄⁄t u
return
€€ 

BadRequest
€€ !
(
€€! "

_resultado
€€" ,
)
€€, -
;
€€- .
}
‹‹ 
if
ﬁﬁ 
(
ﬁﬁ 
idTyper
ﬁﬁ 
==
ﬁﬁ 
null
ﬁﬁ 
||
ﬁﬁ  "
idTyper
ﬁﬁ# *
.
ﬁﬁ* +
Equals
ﬁﬁ+ 1
(
ﬁﬁ1 2
$str
ﬁﬁ2 4
)
ﬁﬁ4 5
)
ﬁﬁ5 6
{
ﬂﬂ 

_resultado
‡‡ 
=
‡‡ 
ConvertidorDeJson
‡‡ .
.
‡‡. /'
ConvertirResultadoFallido
‡‡/ H
(
‡‡H I
$str
‡‡I s
)
‡‡s t
;
‡‡t u
return
·· 

BadRequest
·· !
(
··! "

_resultado
··" ,
)
··, -
;
··- .
}
‚‚ 
	Pertenece
‰‰  
perteneceAEliminar
‰‰ (
=
‰‰) *
_mensajesContext
‰‰+ ;
.
‰‰; <

Perteneces
‰‰< F
.
‰‰F G
SingleOrDefault
‰‰G V
(
‰‰V W
	pertenece
‰‰W `
=>
‰‰a c
	pertenece
ÂÂ 
.
ÂÂ 
IdGrupo
ÂÂ !
==
ÂÂ" $
idGrupo
ÂÂ% ,
&&
ÂÂ- /
	pertenece
ÂÂ0 9
.
ÂÂ9 :
IdTyper
ÂÂ: A
.
ÂÂA B
Equals
ÂÂB H
(
ÂÂH I
idTyper
ÂÂI P
)
ÂÂP Q
)
ÊÊ 
;
ÊÊ 
if
ËË 
(
ËË  
perteneceAEliminar
ËË "
!=
ËË# %
null
ËË& *
)
ËË* +
{
ÈÈ 
_mensajesContext
ÍÍ  
.
ÍÍ  !

Perteneces
ÍÍ! +
.
ÍÍ+ ,
Remove
ÍÍ, 2
(
ÍÍ2 3 
perteneceAEliminar
ÍÍ3 E
)
ÍÍE F
;
ÍÍF G
int
ÏÏ 
	resultado
ÏÏ 
;
ÏÏ 
try
ÓÓ 
{
ÔÔ 
	resultado
 
=
 
await
  %
_mensajesContext
& 6
.
6 7
SaveChangesAsync
7 G
(
G H
)
H I
;
I J
}
ÒÒ 
catch
ÚÚ 
(
ÚÚ 
DbUpdateException
ÚÚ (
e
ÚÚ) *
)
ÚÚ* +
{
ÛÛ 
_logger
ÙÙ 
.
ÙÙ 
LogError
ÙÙ $
(
ÙÙ$ %
$str
ÙÙ% ?
+
ÙÙ@ A
e
ÙÙB C
.
ÙÙC D
InnerException
ÙÙD R
.
ÙÙR S
Message
ÙÙS Z
)
ÙÙZ [
;
ÙÙ[ \

_resultado
ıı 
=
ıı  
ConvertidorDeJson
ıı! 2
.
ıı2 3'
ConvertirResultadoFallido
ıı3 L
(
ııL M
e
ııM N
.
ııN O
InnerException
ııO ]
.
ıı] ^
Message
ıı^ e
)
ııe f
;
ııf g
return
ˆˆ 

BadRequest
ˆˆ %
(
ˆˆ% &

_resultado
ˆˆ& 0
)
ˆˆ0 1
;
ˆˆ1 2
}
˜˜ 
if
˘˘ 
(
˘˘ 
	resultado
˘˘ 
==
˘˘  %
NINGUN_CAMBIO_REALIZADO
˘˘! 8
)
˘˘8 9
{
˙˙ 

_resultado
˚˚ 
=
˚˚  
ConvertidorDeJson
˚˚! 2
.
˚˚2 3'
ConvertirResultadoFallido
˚˚3 L
(
˚˚L M
$str
˚˚M u
)
˚˚u v
;
˚˚v w
return
¸¸ 

BadRequest
¸¸ %
(
¸¸% &

_resultado
¸¸& 0
)
¸¸0 1
;
¸¸1 2
}
˝˝ 
}
˛˛ 
else
ˇˇ 
{
ÄÄ 

_resultado
ÅÅ 
=
ÅÅ 
ConvertidorDeJson
ÅÅ .
.
ÅÅ. /'
ConvertirResultadoFallido
ÅÅ/ H
(
ÅÅH I
$str
ÅÅI ~
)
ÅÅ~ 
;ÅÅ Ä
return
ÇÇ 

BadRequest
ÇÇ !
(
ÇÇ! "

_resultado
ÇÇ" ,
)
ÇÇ, -
;
ÇÇ- .
}
ÉÉ 

_resultado
ÖÖ 
=
ÖÖ 
ConvertidorDeJson
ÖÖ *
.
ÖÖ* +'
ConvertirResultadoExitoso
ÖÖ+ D
(
ÖÖD E
$str
ÖÖE `
,
ÖÖ` a 
perteneceAEliminar
ÖÖb t
)
ÖÖt u
;
ÖÖu v
return
ÜÜ 
Ok
ÜÜ 
(
ÜÜ 

_resultado
ÜÜ  
)
ÜÜ  !
;
ÜÜ! "
}
áá 	
}
àà 
}ââ ÅV
6D:\typeme\MSMensajes\Controllers\MensajesController.cs
	namespace 	

MSMensajes
 
. 
Controllers  
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class 
MensajesController #
:$ %
ControllerBase& 4
{ 
private 
readonly 
MensajesContext (
_mensajesContext) 9
;9 :
private 
readonly 
ILogger  
<  !
MensajesController! 3
>3 4
_logger5 <
;< =
private 
const 
int 
VALOR_MINIMO_ID )
=* +
$num, -
;- .
private 
const 
int #
NINGUN_CAMBIO_REALIZADO 1
=2 3
$num4 5
;5 6
private 
JObject 

_resultado "
;" #
public 
MensajesController !
(! "
ILogger" )
<) *
MensajesController* <
>< =
logger> D
)D E
{ 	
_logger 
= 
logger 
; 
_mensajesContext 
= 
new "
MensajesContext# 2
(2 3
)3 4
;4 5
} 	
[$$ 	
HttpPost$$	 
($$ 
$str$$ 
)$$ 
]$$ 
public%% 
async%% 
Task%% 
<%% 
ActionResult%% &
<%%& '
JObject%%' .
>%%. /
>%%/ 0
EnviarMensaje%%1 >
(%%> ?
[%%? @
FromBody%%@ H
]%%H I
Mensaje%%J Q
nuevoMensaje%%R ^
)%%^ _
{&& 	
if'' 
('' 
nuevoMensaje'' 
=='' 
null''  $
)''$ %
{(( 
_logger)) 
.)) 
LogError))  
())  !
$str))! :
))): ;
;)); <

_resultado** 
=** 
ConvertidorDeJson** .
.**. /%
ConvertirResultadoFallido**/ H
(**H I
$str**I b
)**b c
;**c d
return++ 

BadRequest++ !
(++! "

_resultado++" ,
)++, -
;++- .
},, 
bool.. 
existeGrupo.. 
=.. 
_mensajesContext.. /
.../ 0
Grupos..0 6
...6 7
Any..7 :
(..: ;
grupo..; @
=>..A C
grupo..D I
...I J
IdGrupo..J Q
==..R T
nuevoMensaje..U a
...a b
IdGrupo..b i
)..i j
;..j k
if00 
(00 
!00 
existeGrupo00 
)00 
{11 
_logger22 
.22 
LogError22  
(22  !
$str22! L
)22L M
;22M N

_resultado33 
=33 
ConvertidorDeJson33 .
.33. /%
ConvertirResultadoFallido33/ H
(33H I
$str33I t
)33t u
;33u v
return44 

BadRequest44 !
(44! "

_resultado44" ,
)44, -
;44- .
}55 
bool77 %
esTyperIntegranteDelGrupo77 *
=77+ ,
_mensajesContext77- =
.77= >

Perteneces77> H
.77H I
Any77I L
(77L M
typer77M R
=>77S U
typer88 
.88 
IdGrupo88 
==88  
nuevoMensaje88! -
.88- .
IdGrupo88. 5
&&886 8
typer889 >
.88> ?
IdTyper88? F
.88F G
Equals88G M
(88M N
nuevoMensaje88N Z
.88Z [
IdTyper88[ b
)88b c
)99 
;99 
if;; 
(;; 
!;; %
esTyperIntegranteDelGrupo;; *
);;* +
{<< 
_logger== 
.== 
LogError==  
(==  !
$str==! A
)==A B
;==B C

_resultado>> 
=>> 
ConvertidorDeJson>> .
.>>. /%
ConvertirResultadoFallido>>/ H
(>>H I
$str>>I i
)>>i j
;>>j k
return?? 

BadRequest?? !
(??! "

_resultado??" ,
)??, -
;??- .
}@@ 
nuevoMensajeBB 
.BB 
FechaBB 
=BB  
DateTimeBB! )
.BB) *
NowBB* -
;BB- .
stringCC 

horaActualCC 
=CC 
DateTimeCC  (
.CC( )
NowCC) ,
.CC, -
ToStringCC- 5
(CC5 6
$strCC6 =
)CC= >
;CC> ?
nuevoMensajeDD 
.DD 
HoraDD 
=DD 
TimeSpanDD  (
.DD( )
ParseDD) .
(DD. /

horaActualDD/ 9
)DD9 :
;DD: ;
_mensajesContextEE 
.EE 
EntryEE "
(EE" #
nuevoMensajeEE# /
)EE/ 0
.EE0 1
StateEE1 6
=EE7 8
EntityStateEE9 D
.EED E
AddedEEE J
;EEJ K
intGG 
	resultadoGG 
;GG 
tryII 
{JJ 
	resultadoKK 
=KK 
awaitKK !
_mensajesContextKK" 2
.KK2 3
SaveChangesAsyncKK3 C
(KKC D
)KKD E
;KKE F
}LL 
catchMM 
(MM 
DbUpdateExceptionMM $
eMM% &
)MM& '
{NN 
_loggerOO 
.OO 
LogErrorOO  
(OO  !
$strOO! ;
+OO< =
eOO> ?
.OO? @
MessageOO@ G
)OOG H
;OOH I

_resultadoPP 
=PP 
ConvertidorDeJsonPP .
.PP. /%
ConvertirResultadoFallidoPP/ H
(PPH I
ePPI J
.PPJ K
MessagePPK R
)PPR S
;PPS T
returnQQ 

BadRequestQQ !
(QQ! "

_resultadoQQ" ,
)QQ, -
;QQ- .
}RR 
ifTT 
(TT 
	resultadoTT 
==TT #
NINGUN_CAMBIO_REALIZADOTT 4
)TT4 5
{UU 

_resultadoVV 
=VV 
ConvertidorDeJsonVV .
.VV. /%
ConvertirResultadoFallidoVV/ H
(VVH I
$strVVI g
)VVg h
;VVh i
returnWW 

BadRequestWW !
(WW! "

_resultadoWW" ,
)WW, -
;WW- .
}XX 

_resultado[[ 
=[[ 
ConvertidorDeJson[[ *
.[[* +%
ConvertirResultadoExitoso[[+ D
([[D E
$str[[E V
,[[V W
nuevoMensaje[[X d
)[[d e
;[[e f
return\\ 
Ok\\ 
(\\ 

_resultado\\  
)\\  !
;\\! "
}]] 	
[dd 	
HttpGetdd	 
(dd 
$strdd $
)dd$ %
]dd% &
publicee 
asyncee 
Taskee 
<ee 
ActionResultee &
<ee& '
JObjectee' .
>ee. /
>ee/ 0"
ObtenerMensajesDeGrupoee1 G
(eeG H
inteeH K
idGrupoeeL S
)eeS T
{ff 	
ifgg 
(gg 
idGrupogg 
<gg 
VALOR_MINIMO_IDgg )
)gg) *
{hh 

_resultadoii 
=ii 
ConvertidorDeJsonii .
.ii. /%
ConvertirResultadoFallidoii/ H
(iiH I
$striiI b
)iib c
;iic d
returnjj 

BadRequestjj !
(jj! "

_resultadojj" ,
)jj, -
;jj- .
}kk 
Listmm 
<mm 
Mensajemm 
>mm 
mensajesmm "
=mm# $
nullmm% )
;mm) *
tryoo 
{pp 
mensajesqq 
=qq 
awaitqq  
_mensajesContextqq! 1
.qq1 2
Mensajesqq2 :
.rr 
Whererr 
(rr 
mensajerr "
=>rr# %
mensajerr& -
.rr- .
IdGruporr. 5
==rr6 8
idGruporr9 @
)rr@ A
.ss 
ToListAsyncss  
(ss  !
)ss! "
;ss" #
}tt 
catchuu 
(uu !
ArgumentNullExceptionuu (
euu) *
)uu* +
{vv 
_loggerww 
.ww 
LogErrorww  
(ww  !
$strww! ;
+ww< =
eww> ?
.ww? @
Messageww@ G
)wwG H
;wwH I

_resultadoxx 
=xx 
ConvertidorDeJsonxx .
.xx. /%
ConvertirResultadoFallidoxx/ H
(xxH I
exxI J
.xxJ K
MessagexxK R
)xxR S
;xxS T
returnyy 

BadRequestyy !
(yy! "

_resultadoyy" ,
)yy, -
;yy- .
}zz 
catch{{ 
({{ 
MySqlException{{ !
e{{" #
){{# $
{|| 
_logger}} 
.}} 
LogError}}  
(}}  !
$str}}! ;
+}}< =
e}}> ?
.}}? @
Message}}@ G
)}}G H
;}}H I

_resultado~~ 
=~~ 
ConvertidorDeJson~~ .
.~~. /%
ConvertirResultadoFallido~~/ H
(~~H I
e~~I J
.~~J K
Message~~K R
)~~R S
;~~S T
return 

BadRequest !
(! "

_resultado" ,
), -
;- .
}
ÄÄ 
int
ÇÇ 
noHayMensajes
ÇÇ 
=
ÇÇ 
$num
ÇÇ  !
;
ÇÇ! "
if
ÑÑ 
(
ÑÑ 
mensajes
ÑÑ 
==
ÑÑ 
null
ÑÑ  
||
ÑÑ! #
mensajes
ÑÑ$ ,
.
ÑÑ, -
Count
ÑÑ- 2
==
ÑÑ3 5
noHayMensajes
ÑÑ6 C
)
ÑÑC D
{
ÖÖ 
_logger
ÜÜ 
.
ÜÜ 
LogError
ÜÜ  
(
ÜÜ  !
$str
ÜÜ! 2
)
ÜÜ2 3
;
ÜÜ3 4

_resultado
áá 
=
áá 
ConvertidorDeJson
áá .
.
áá. /'
ConvertirResultadoFallido
áá/ H
(
ááH I
$str
ááI f
)
ááf g
;
áág h
return
àà 

BadRequest
àà !
(
àà! "

_resultado
àà" ,
)
àà, -
;
àà- .
}
ââ 

_resultado
ãã 
=
ãã 
ConvertidorDeJson
ãã *
.
ãã* +'
ConvertirResultadoExitoso
ãã+ D
(
ããD E
$str
ããE ^
,
ãã^ _
mensajes
ãã` h
)
ããh i
;
ããi j
return
åå 
Ok
åå 
(
åå 

_resultado
åå  
)
åå  !
;
åå! "
}
çç 	
}
éé 
}èè ¸ 
4D:\typeme\MSMensajes\Converters\ConvertidorDeJson.cs
	namespace 	

MSMensajes
 
. 

Converters 
{ 
public 

static 
class 
ConvertidorDeJson )
{ 
private		 
static		 
JObject		 

_resultado		 )
;		) *
private

 
static

 
JObject

 
_dataObject

 *
;

* +
private 
static 
bool 
_status #
;# $
private 
static 
readonly "
JsonSerializerSettings  6"
_jsonSerializerSetting7 M
=N O
newP S"
JsonSerializerSettingsT j
{ 	!
ReferenceLoopHandling !
=" #!
ReferenceLoopHandling$ 9
.9 :
Ignore: @
} 	
;	 

public 
static 
JObject %
ConvertirResultadoExitoso 7
(7 8
string8 >
message? F
,F G
objectH N
dataO S
)S T
{ 	
_dataObject 
= 
new 
JObject %
{ 
{ 
$str 
, 
message $
}% &
} 
; 
string   
dataJson   
=   
JsonConvert   )
.  ) *
SerializeObject  * 9
(  9 :
data  : >
,  > ?

Formatting  @ J
.  J K
Indented  K S
,  S T"
_jsonSerializerSetting  U k
)  k l
;  l m
if"" 
("" 
EsTipoLista"" 
("" 
data""  
)""  !
)""! "
{## 
_dataObject$$ 
[$$ 
$str$$ $
]$$$ %
=$$& '
JArray$$( .
.$$. /
Parse$$/ 4
($$4 5
dataJson$$5 =
)$$= >
;$$> ?
}%% 
else&& 
{'' 
_dataObject(( 
[(( 
$str(( $
](($ %
=((& '
JObject((( /
.((/ 0
Parse((0 5
(((5 6
dataJson((6 >
)((> ?
;((? @
})) 
_status++ 
=++ 
true++ 
;++ 

_resultado,, 
=,, 
new,, 
JObject,, $
{-- 
{.. 
$str.. 
,.. 
_status.. "
}..# $
,..$ %
{// 
$str// 
,// 
_dataObject// $
}//$ %
}00 
;00 
return22 

_resultado22 
;22 
}33 	
public:: 
static:: 
JObject:: %
ConvertirResultadoFallido:: 7
(::7 8
string::8 >
message::? F
)::F G
{;; 	
_dataObject<< 
=<< 
new<< 
JObject<< %
{== 
{>> 
$str>> 
,>> 
message>> $
}>>% &
,>>& '
{?? 
$str?? 
,?? 
null??  
}??! "
}@@ 
;@@ 
_statusBB 
=BB 
falseBB 
;BB 

_resultadoCC 
=CC 
newCC 
JObjectCC $
{DD 
{EE 
$strEE 
,EE 
_statusEE #
}EE$ %
,EE% &
{FF 
$strFF 
,FF 
_dataObjectFF %
}FF& '
}GG 
;GG 
returnII 

_resultadoII 
;II 
}JJ 	
privateLL 
staticLL 
boolLL 
EsTipoListaLL '
(LL' (
objectLL( .
dataLL/ 3
)LL3 4
{MM 	
returnNN 
(NN 
dataNN 
.NN 
GetTypeNN  
(NN  !
)NN! "
.NN" #
IsGenericTypeNN# 0
&&NN1 3
dataNN4 8
isNN9 ;
IEnumerableNN< G
<NNG H
objectNNH N
>NNN O
)NNO P
;NNP Q
}OO 	
}PP 
}QQ Ñ
$D:\typeme\MSMensajes\Models\Grupo.cs
	namespace 	

MSMensajes
 
. 
Models 
{ 
public 

partial 
class 
Grupo 
{		 
public

 
Grupo

 
(

 
)

 
{ 	
Mensajes 
= 
new 
HashSet "
<" #
Mensaje# *
>* +
(+ ,
), -
;- .

Perteneces 
= 
new 
HashSet $
<$ %
	Pertenece% .
>. /
(/ 0
)0 1
;1 2
} 	
public 
int 
IdGrupo 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
Nombre 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Descripcion !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
DateTime 
FechaCreacion %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
virtual 
ICollection "
<" #
Mensaje# *
>* +
Mensajes, 4
{5 6
get7 :
;: ;
set< ?
;? @
}A B
public 
virtual 
ICollection "
<" #
	Pertenece# ,
>, -

Perteneces. 8
{9 :
get; >
;> ?
set@ C
;C D
}E F
} 
} ˘
&D:\typeme\MSMensajes\Models\Mensaje.cs
	namespace 	

MSMensajes
 
. 
Models 
{ 
public 

partial 
class 
Mensaje  
{		 
public

 
int

 
	IdMensaje

 
{

 
get

 "
;

" #
set

$ '
;

' (
}

) *
public 
string 
	Contenido 
{  !
get" %
;% &
set' *
;* +
}, -
public 
DateTime 
Fecha 
{ 
get  #
;# $
set% (
;( )
}* +
public 
TimeSpan 
Hora 
{ 
get "
;" #
set$ '
;' (
}) *
public 
int 
IdGrupo 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
IdTyper 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
IdMultimedia "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
virtual 
Grupo 
IdGrupoNavigation .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
} 
} £Q
.D:\typeme\MSMensajes\Models\MensajesContext.cs
	namespace 	

MSMensajes
 
. 
Models 
{ 
public		 

partial		 
class		 
MensajesContext		 (
:		) *
	DbContext		+ 4
{

 
public 
MensajesContext 
( 
)  
{ 	
} 	
public 
MensajesContext 
( 
DbContextOptions /
</ 0
MensajesContext0 ?
>? @
optionsA H
)H I
: 
base 
( 
options 
) 
{ 	
} 	
public 
virtual 
DbSet 
< 
Grupo "
>" #
Grupos$ *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
public 
virtual 
DbSet 
< 
Mensaje $
>$ %
Mensajes& .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
public 
virtual 
DbSet 
< 
	Pertenece &
>& '

Perteneces( 2
{3 4
get5 8
;8 9
set: =
;= >
}? @
	protected 
override 
void 
OnConfiguring  -
(- .#
DbContextOptionsBuilder. E
optionsBuilderF T
)T U
{ 	
if 
( 
! 
optionsBuilder 
.  
IsConfigured  ,
), -
{ 
string 
connectionString '
=( )
Environment* 5
.5 6"
GetEnvironmentVariable6 L
(L M
$strM c
)c d
;d e
optionsBuilder 
. 
UseMySql '
(' (
connectionString( 8
,8 9
	Microsoft: C
.C D
EntityFrameworkCoreD W
.W X
ServerVersionX e
.e f

FromStringf p
(p q
$strq 
)	 Ä
,
Ä Å
builder 
=> 
{  
builder 
.   
EnableRetryOnFailure  4
(4 5
$num5 6
,6 7
TimeSpan8 @
.@ A
FromSecondsA L
(L M
$numM O
)O P
,P Q
nullR V
)V W
;W X
}   
)   
;   
base!! 
.!! 
OnConfiguring!! "
(!!" #
optionsBuilder!!# 1
)!!1 2
;!!2 3
}"" 
}## 	
	protected%% 
override%% 
void%% 
OnModelCreating%%  /
(%%/ 0
ModelBuilder%%0 <
modelBuilder%%= I
)%%I J
{&& 	
modelBuilder'' 
.'' 
Entity'' 
<''  
Grupo''  %
>''% &
(''& '
entity''' -
=>''. 0
{(( 
entity)) 
.)) 
HasKey)) 
()) 
e)) 
=>))  "
e))# $
.))$ %
IdGrupo))% ,
))), -
.** 
HasName** 
(** 
$str** &
)**& '
;**' (
entity,, 
.,, 
Property,, 
(,,  
e,,  !
=>,," $
e,,% &
.,,& '
Descripcion,,' 2
),,2 3
.-- 
HasColumnType-- "
(--" #
$str--# 1
)--1 2
... 

HasCharSet.. 
(..  
$str..  &
)..& '
.// 
HasCollation// !
(//! "
$str//" 3
)//3 4
;//4 5
entity11 
.11 
Property11 
(11  
e11  !
=>11" $
e11% &
.11& '
FechaCreacion11' 4
)114 5
.115 6
HasColumnType116 C
(11C D
$str11D J
)11J K
;11K L
entity33 
.33 
Property33 
(33  
e33  !
=>33" $
e33% &
.33& '
Nombre33' -
)33- .
.44 
HasColumnType44 "
(44" #
$str44# 0
)440 1
.55 

HasCharSet55 
(55  
$str55  &
)55& '
.66 
HasCollation66 !
(66! "
$str66" 3
)663 4
;664 5
}77 
)77 
;77 
modelBuilder99 
.99 
Entity99 
<99  
Mensaje99  '
>99' (
(99( )
entity99) /
=>990 2
{:: 
entity;; 
.;; 
HasKey;; 
(;; 
e;; 
=>;;  "
e;;# $
.;;$ %
	IdMensaje;;% .
);;. /
.<< 
HasName<< 
(<< 
$str<< &
)<<& '
;<<' (
entity>> 
.>> 
HasIndex>> 
(>>  
e>>  !
=>>>" $
e>>% &
.>>& '
IdGrupo>>' .
,>>. /
$str>>0 B
)>>B C
;>>C D
entity@@ 
.@@ 
Property@@ 
(@@  
e@@  !
=>@@" $
e@@% &
.@@& '
	Contenido@@' 0
)@@0 1
.AA 

IsRequiredAA 
(AA  
)AA  !
.BB 
HasColumnTypeBB "
(BB" #
$strBB# /
)BB/ 0
.CC 

HasCharSetCC 
(CC  
$strCC  &
)CC& '
.DD 
HasCollationDD !
(DD! "
$strDD" 3
)DD3 4
;DD4 5
entityFF 
.FF 
PropertyFF 
(FF  
eFF  !
=>FF" $
eFF% &
.FF& '
FechaFF' ,
)FF, -
.FF- .
HasColumnTypeFF. ;
(FF; <
$strFF< B
)FFB C
;FFC D
entityHH 
.HH 
PropertyHH 
(HH  
eHH  !
=>HH" $
eHH% &
.HH& '
HoraHH' +
)HH+ ,
.HH, -
HasColumnTypeHH- :
(HH: ;
$strHH; A
)HHA B
;HHB C
entityJJ 
.JJ 
PropertyJJ 
(JJ  
eJJ  !
=>JJ" $
eJJ% &
.JJ& '
IdMultimediaJJ' 3
)JJ3 4
.KK 

IsRequiredKK 
(KK  
)KK  !
.LL 
HasColumnTypeLL "
(LL" #
$strLL# 0
)LL0 1
.MM 

HasCharSetMM 
(MM  
$strMM  &
)MM& '
.NN 
HasCollationNN !
(NN! "
$strNN" 3
)NN3 4
;NN4 5
entityPP 
.PP 
PropertyPP 
(PP  
ePP  !
=>PP" $
ePP% &
.PP& '
IdTyperPP' .
)PP. /
.QQ 

IsRequiredQQ 
(QQ  
)QQ  !
.RR 
HasColumnTypeRR "
(RR" #
$strRR# 0
)RR0 1
.SS 

HasCharSetSS 
(SS  
$strSS  &
)SS& '
.TT 
HasCollationTT !
(TT! "
$strTT" 3
)TT3 4
;TT4 5
entityVV 
.VV 
HasOneVV 
(VV 
dVV 
=>VV  "
dVV# $
.VV$ %
IdGrupoNavigationVV% 6
)VV6 7
.WW 
WithManyWW 
(WW 
pWW 
=>WW  "
pWW# $
.WW$ %
MensajesWW% -
)WW- .
.XX 
HasForeignKeyXX "
(XX" #
dXX# $
=>XX% '
dXX( )
.XX) *
IdGrupoXX* 1
)XX1 2
.YY 
HasConstraintNameYY &
(YY& '
$strYY' 9
)YY9 :
;YY: ;
}ZZ 
)ZZ 
;ZZ 
modelBuilder\\ 
.\\ 
Entity\\ 
<\\  
	Pertenece\\  )
>\\) *
(\\* +
entity\\+ 1
=>\\2 4
{]] 
entity^^ 
.^^ 
HasKey^^ 
(^^ 
e^^ 
=>^^  "
new^^# &
{^^' (
e^^) *
.^^* +
IdGrupo^^+ 2
,^^2 3
e^^4 5
.^^5 6
IdTyper^^6 =
}^^> ?
)^^? @
.__ 
HasName__ 
(__ 
$str__ &
)__& '
.`` 
HasAnnotation`` "
(``" #
$str``# <
,``< =
new``> A
[``A B
]``B C
{``D E
$num``F G
,``G H
$num``I J
}``K L
)``L M
;``M N
entitybb 
.bb 
ToTablebb 
(bb 
$strbb *
)bb* +
;bb+ ,
entitydd 
.dd 
Propertydd 
(dd  
edd  !
=>dd" $
edd% &
.dd& '
IdTyperdd' .
)dd. /
.ee 
HasColumnTypeee "
(ee" #
$stree# 0
)ee0 1
.ff 

HasCharSetff 
(ff  
$strff  &
)ff& '
.gg 
HasCollationgg !
(gg! "
$strgg" 3
)gg3 4
;gg4 5
entityii 
.ii 
HasOneii 
(ii 
dii 
=>ii  "
dii# $
.ii$ %
IdGrupoNavigationii% 6
)ii6 7
.jj 
WithManyjj 
(jj 
pjj 
=>jj  "
pjj# $
.jj$ %

Pertenecesjj% /
)jj/ 0
.kk 
HasForeignKeykk "
(kk" #
dkk# $
=>kk% '
dkk( )
.kk) *
IdGrupokk* 1
)kk1 2
.ll 
HasConstraintNamell &
(ll& '
$strll' <
)ll< =
;ll= >
}mm 
)mm 
;mm "
OnModelCreatingPartialoo "
(oo" #
modelBuilderoo# /
)oo/ 0
;oo0 1
}pp 	
partialrr 
voidrr "
OnModelCreatingPartialrr +
(rr+ ,
ModelBuilderrr, 8
modelBuilderrr9 E
)rrE F
;rrF G
}ss 
}tt Ò
(D:\typeme\MSMensajes\Models\Pertenece.cs
	namespace 	

MSMensajes
 
. 
Models 
{ 
public 

partial 
class 
	Pertenece "
{		 
public

 
int

 
IdGrupo

 
{

 
get

  
;

  !
set

" %
;

% &
}

' (
public 
string 
IdTyper 
{ 
get  #
;# $
set% (
;( )
}* +
public 
virtual 
Grupo 
IdGrupoNavigation .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
} 
} ˜	
D:\typeme\MSMensajes\Program.cs
	namespace

 	

MSMensajes


 
{ 
public 

class 
Program 
{ 
public 
static 
void 
Main 
(  
string  &
[& '
]' (
args) -
)- .
{ 	
CreateHostBuilder 
( 
args "
)" #
.# $
Build$ )
() *
)* +
.+ ,
Run, /
(/ 0
)0 1
;1 2
} 	
public 
static 
IHostBuilder "
CreateHostBuilder# 4
(4 5
string5 ;
[; <
]< =
args> B
)B C
=>D F
Host 
.  
CreateDefaultBuilder %
(% &
args& *
)* +
. $
ConfigureWebHostDefaults )
() *

webBuilder* 4
=>5 7
{ 

webBuilder 
. 

UseStartup )
<) *
Startup* 1
>1 2
(2 3
)3 4
;4 5
} 
) 
; 
} 
} Ç
D:\typeme\MSMensajes\Startup.cs
	namespace 	

MSMensajes
 
{ 
public 

class 
Startup 
{ 
public 
Startup 
( 
IConfiguration %
configuration& 3
)3 4
{ 	
Configuration 
= 
configuration )
;) *
} 	
public 
IConfiguration 
Configuration +
{, -
get. 1
;1 2
}3 4
public 
void 
ConfigureServices %
(% &
IServiceCollection& 8
services9 A
)A B
{ 	
services 
. 
AddControllers #
(# $
)$ %
.% &
AddNewtonsoftJson& 7
(7 8
)8 9
;9 :
services 
. 
AddSwaggerGen "
(" #
c# $
=>% '
{   
c!! 
.!! 

SwaggerDoc!! 
(!! 
$str!! !
,!!! "
new!!# &
OpenApiInfo!!' 2
{!!3 4
Title!!5 :
=!!; <
$str!!= I
,!!I J
Version!!K R
=!!S T
$str!!U Y
}!!Z [
)!![ \
;!!\ ]
}"" 
)"" 
;"" 
}## 	
public&& 
void&& 
	Configure&& 
(&& 
IApplicationBuilder&& 1
app&&2 5
,&&5 6
IWebHostEnvironment&&7 J
env&&K N
)&&N O
{'' 	
if(( 
((( 
env(( 
.(( 
IsDevelopment(( !
(((! "
)((" #
)((# $
{)) 
app** 
.** %
UseDeveloperExceptionPage** -
(**- .
)**. /
;**/ 0
app++ 
.++ 

UseSwagger++ 
(++ 
)++  
;++  !
app,, 
.,, 
UseSwaggerUI,,  
(,,  !
c,,! "
=>,,# %
c,,& '
.,,' (
SwaggerEndpoint,,( 7
(,,7 8
$str,,8 R
,,,R S
$str,,T c
),,c d
),,d e
;,,e f
}-- 
app11 
.11 

UseRouting11 
(11 
)11 
;11 
app33 
.33 
UseAuthorization33  
(33  !
)33! "
;33" #
app55 
.55 
UseEndpoints55 
(55 
	endpoints55 &
=>55' )
{66 
	endpoints77 
.77 
MapControllers77 (
(77( )
)77) *
;77* +
}88 
)88 
;88 
}99 	
}:: 
};; 